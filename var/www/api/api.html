<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>API TEST FRONTPAGE </title>
	<style>
		* {
			margin: 0;
			padding: 0;
		}
		body {
			font-family: Favorit,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif;
			display: flex;
			justify-content: center;
			align-items: center;
			height: 90vh;
		}
		.error-container {
			display: flex;
			flex-direction: column;
			gap: 0.75rem;
			text-align: center;
			max-width: 600px;
		}
		.error-container img {
			max-width: 200px;
			margin: 0 auto;
			opacity: 0.9;
		}
		h1 {
			font-size: 3rem;
			font-weight: 600;
		}
		p {
			font-size: 1rem;
			line-height: 1.3;
		}
		.button {
			display: inline-block;
			text-decoration: none;
			font-weight: 500;
			transition: opacity 0.15s ease;
		}
		.button:hover {
			opacity: 0.8;
			text-decoration: underline;
		}
	</style>
</head>
<body>
	<div class="error-container">
		<h1>API TEST FRONTPAGE</h1>
		<p>Message to be defined</p>
		<a href="/" class="button">← Return to homepage</a>
	</div>

<h2>Upload de fichiers</h2>

<div id="fileInputsContainer">
    <div class="file-row">
        <input type="file" class="fileInput" required>
        <button type="button" class="removeBtn">❌</button>
    </div>
</div>

<button type="button" id="addFileBtn">Ajouter un fichier</button>
<br><br>
<button id="submitAllBtn">Envoyer tous les fichiers</button>

<p id="result"></p>


<script>
const container = document.getElementById("fileInputsContainer");

// Ajouter un nouveau fichier
document.getElementById("addFileBtn").addEventListener("click", () => {
    const div = document.createElement("div");
    div.className = "file-row";
    div.innerHTML = `
        <input type="file" class="fileInput" required>
        <button type="button" class="removeBtn">❌</button>
    `;
    container.appendChild(div);
});

// Retirer un fichier
container.addEventListener("click", (e) => {
    if (e.target.classList.contains("removeBtn")) {
        e.target.parentElement.remove();
    }
});

// Envoyer tous les fichiers
document.getElementById("submitAllBtn").addEventListener("click", () => {
    const formData = new FormData();
    const fileInputs = document.querySelectorAll(".fileInput");

    fileInputs.forEach((input, index) => {
        if (input.files.length > 0) {
            formData.append("file", input.files[0]);
        }
    });

    fetch("http://localhost:8080/api/", {
        method: "POST",
        body: formData
    })
    .then(response => {
        document.getElementById("result").innerText =
            "HTTP status: " + response.status;
    })
    .catch(err => {
        document.getElementById("result").innerText =
            "Erreur réseau";
    });
});

</script>
</body>
</html>
